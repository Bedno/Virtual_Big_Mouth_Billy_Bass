<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=1" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<head>
<title>Virtual Big Mouthed Billy Bass</title>
</head>
<script>
// Basic web-based text-to-speech talking animated character.  http://VirtualBillyBass.com
// More info at https://github.com/bedno/Virtual_Big_Mouth_Billy_Bass
var SpeechTxt = "";  var TailNextIdx = 0;
var TimerMouth = null;  var TimerTail = null;
function UpdMouth() {
  var MouthChar = document.getElementById('CharMouth').innerText;
  if (MouthChar == '>') {
    MouthChar = '=';
    if (TimerMouth) { clearTimeout(TimerMouth); }
    TimerMouth = setTimeout('UpdMouth()',150);
  } else {
    MouthChar = '-';
  }
  document.getElementById('CharMouth').innerText = MouthChar;
}
function ActMouth() {
  document.getElementById('CharMouth').innerText = '>';
  if (TimerMouth) { clearTimeout(TimerMouth); }
  TimerMouth = setTimeout('UpdMouth()',150);
}
function UpdTail() {
  document.getElementById('CharTail').innerText = '[';
}
function ActTail() {
  document.getElementById('CharTail').innerText = '<';
  if (TimerTail) { clearTimeout(TimerTail); }
  TimerTail = setTimeout('UpdTail()',350);
}
function SpeechLog(SLin) {
  document.getElementById('SpeechConsole').innerHTML = SLin+document.getElementById('SpeechConsole').innerHTML;
}
function SpeechDone(SpeechEvent) {
  SpeechLog('Finished in '+(Math.round((SpeechEvent.elapsedTime/100))/10).toString()+" seconds.\n");
};
function SpeechWord(SpeechEvent) {
  ActMouth();
  if (SpeechEvent.charIndex>TailNextIdx) { ActTail(); TailNextIdx += 20+Math.floor(Math.random()*20); }
  SpeechLog(SpeechEvent.name+':'+SpeechEvent.charIndex+"\n");
};
function SpeechDo () {
  SpeechTxt = document.getElementById('SpeechText').value;
  TailNextIdx = SpeechTxt.length/2;  if (TailNextIdx>22) { TailNextIdx = 20+Math.floor(Math.random()*20); }
  if ('speechSynthesis' in window) {  // If browser is speech capable
    var SpeechVoices = window.speechSynthesis.getVoices();
    window.speechSynthesis.cancel();  // Cancel any existing speaking
    var SpeechHandle = new SpeechSynthesisUtterance();  // Initialize a speech handle
    SpeechHandle.voice = SpeechVoices[10];  // Select voice and other settings.
    SpeechHandle.voiceURI = 'native';
    SpeechHandle.volume = 1.0; // 0 to 1
    SpeechHandle.rate = 1.0; // 0.1 to 10
    SpeechHandle.pitch = 1.0; // 0 to 2
    SpeechHandle.lang = 'en-US';
    SpeechHandle.text = SpeechTxt;
    // Connect the completion callback.
    SpeechHandle.onend = SpeechDone;
    // Connect the word boundary callback.
    SpeechHandle.onboundary = SpeechWord;
    // Speak the passed phrase.
    window.speechSynthesis.speak(SpeechHandle);
  } else {
    SpeechLog("This device does not support text to speech.\n");
  }
}

</script>
<body><font face="Arial" size=2>
<center><br><br>
<font size=3><a href="http://VirtualBillyBass.com">Virtual Big Mouth Billy Bass</a><br></font>
<span onClick="SpeechDo();"><font size="9" color="#0000C0"><span id="CharMouth">-</span>:<span id="CharTail">[</span></font></span><br>
<input type="button" onClick="SpeechDo();" value="SPEAK"><br>
<textarea rows="3" cols="32" name='SpeechText' id='SpeechText'>
I wanna know, can you tell me?
I'd love to stay
Take me to the river, drop me in the water
Take me to the river, drop me in the water
</textarea><br>

<font size=1>
Initial exploration of web-based possibilities for creation of a text-to-speech talking animated character.<br>
Speaks entered text while animating mouth, head and tail in sync.  Version 0.1, symbols represent body parts.<br>
Next to do's:  1. Create actual graphics for frame images.  2. Speak a fetched weather report.<br>
More info: <a href="https://github.com/bedno/Virtual_Big_Mouth_Billy_Bass" target="github">https://github.com/bedno/Virtual_Big_Mouth_Billy_Bass</a><br>
</font>
<br><br>

<div id="SpeechConsole" style="height:92px; width:600px; overflow:hidden; font-size:7pt; color:white;"></div><br><br>

</br></center>
</font></body>
</html>

